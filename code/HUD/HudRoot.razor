@using Sandbox;
@using Sandbox.UI;
@attribute [Title("Player HUD Element")]
@attribute [Icon("screen_share")]
@attribute [Group("Physbox")]
@attribute [Tint(EditorTint.Yellow)]
@inherits PanelComponent
@namespace Physbox

@if (Player is null || IsProxy || !DrawHud) return;
@if (PauseMenu.Paused) return;

<root>
	@if ( GameLogicComponent.UseTimer && !Game.RoundOver )
	{
		<Timer></Timer>
	}

	@if ( Input.Down( "score" ))
	{
		<Scoreboard></Scoreboard>
	}

	@if ( Game.RoundOver && Game.GameModeComponent.Winner is not null )
	{
		<WinnerDisplay Winner="@(Game.GameModeComponent.Winner)"></WinnerDisplay>
	}

	@if (Player.IsAlive)
	{
		<Health></Health>
		<Score></Score>

		@if (!Input.Down("score"))
		{
			<PropSelector></PropSelector>
		}

		@if ( Player.HeldGameObject is not null )
		{
			<Charge></Charge>
			<HeldProp></HeldProp>
		}
	}
	else
	{
		<DeadMessage></DeadMessage>
	}
</root>

@code
{
	[ConVar("pb_player_drawhud", ConVarFlags.Cheat)]
	public static bool DrawHud { get; set; } = true;

	PlayerComponent Player => PlayerComponent.LocalPlayer;
	GameLogicComponent Game => GameLogicComponent.GetGameInstance();

	/// <summary>
	/// the hash determines if the system should be rebuilt. If it changes, it will be rebuilt
	/// </summary>
	protected override int BuildHash() => System.HashCode.Combine( Time.Now );
}
